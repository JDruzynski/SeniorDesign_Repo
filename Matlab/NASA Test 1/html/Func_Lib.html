<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2019b"><title>Function Library</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 10px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 15px; font-weight: 700; text-align: left;  }
.S3 { border-left: 0px none rgb(0, 0, 0); border-right: 0px none rgb(0, 0, 0); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px; line-height: 16px; min-height: 16px; white-space: pre; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;  }
.S4 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S5 { border-left: 0.994318px solid rgb(233, 233, 233); border-right: 0.994318px solid rgb(233, 233, 233); border-top: 0.994318px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S6 { border-left: 0.994318px solid rgb(233, 233, 233); border-right: 0.994318px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 0.994318px solid rgb(233, 233, 233); border-right: 0.994318px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0.994318px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S9 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S10 { border-left: 0.994318px solid rgb(233, 233, 233); border-right: 0.994318px solid rgb(233, 233, 233); border-top: 0.994318px solid rgb(233, 233, 233); border-bottom: 0.994318px solid rgb(233, 233, 233); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Function Library</span></h1><div  class = 'S1'><span>Creates a structure of function handles. To use, call the function at the beginning of your script and assign to a variable. From there call a function within the structure as you would any structure field</span></div><h4  class = 'S2'><span>Ex:</span></h4><div class = 'preformatted-matlab' style = 'margin: 10px 3px 10px 55px; padding: 10px 10px 10px 5px; '><div  class = 'S3'><span style="white-space: pre;"><span>f = Func_lib;</span></span></div><div  class = 'S3'><span style="white-space: pre;"><span>a = f.V_Comp(V_1,V_2,V_s);</span></span></div></div><h2  class = 'S4'><span>Main Function</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>f = Func_Lib</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.connectAlicat = @connectAlicat;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.setFlow = @setFlow;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.calcFlow = @calcFlow;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.flushAlicatBuffer= @flushAlicatBuffer;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.ConnectArduino = @ConnectArduino;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.InitializeSensors = @InitializeSensors;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.thermocouple_read = @thermocouple_read;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.radiometer_read = @radiometer_read;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.pressure_read = @pressure_read;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.scale_read = @scale_read;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    f.thermistor_read = @thermistor_read;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><h2  class = 'S8'><span>Alicat Setup and Functions</span></h2><h4  class = 'S2'><span>a</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>aliComm=connectAlicat</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% * Purpose</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% Form a connection to the Alicat controller. By default </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% connects to COM port hard-coded into file. User may overide</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% this.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    COM=</span><span style="color: rgb(160, 32, 240);">'COM1'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    fprintf(</span><span style="color: rgb(160, 32, 240);">'Connecting to Alicats on port %s\n'</span><span>,COM)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    aliComm=serial(COM,</span><span style="color: rgb(0, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(160, 32, 240);">'TimeOut'</span><span>, 2,</span><span style="color: rgb(0, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(160, 32, 240);">'BaudRate'</span><span>, 19200,</span><span style="color: rgb(0, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(160, 32, 240);">'Terminator'</span><span>,</span><span style="color: rgb(160, 32, 240);">'CR'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%delete(instrfind)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    fopen(aliComm);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%fclose(aliComm)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%delete(aliComm)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%clear aliComm</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><h4  class = 'S2'><span>a</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>setFlow(flowRate,odourConc)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% function setFlow(flowRate,odourConc)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% Set the flow rate of the combined odour stream and the odour</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% concentration. Or change flow of just one controller:</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% flowRate - desired flow rate produced by both controllers (unless</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%            odourConc is a controller ID). UNITS: SLPM.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% odourConc- i. maintains the same overall flow rate but changes the odour</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%            concentration. UNITS: 0--100% of 1 SLPM </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%            ii. If odourConc is a controller ID (e.g. 'A' or 'B') then the </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%            function sets the named controller to the flow  pecified by </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%            flowRate. Can be a char array of several unit IDs in which</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%            case all are set to flowRate.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% examples -</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% setFlow(0.5,'A') %Set controler A to half full scale</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% setFlow(2100/5000,'C') %Set 5 SLPM controler, C, to 2.1 SLPM</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% Rob Campbell - 21st March 2008 - CSHL</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% flowRate = flowRate/20;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">global </span><span class="nonlocalVariableHighlighting">aliComm</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">if </span><span>isempty(</span><span class="nonlocalVariableHighlighting">aliComm</span><span>), </span><span class="nonlocalVariableHighlighting">aliComm</span><span>=connectAlicat; </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">if </span><span>ischar(odourConc)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        flowRate=round(flowRate*1000)/1000;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        flowRate=str2double(sprintf(</span><span style="color: rgb(160, 32, 240);">'%0.3g'</span><span>,flowRate));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">for </span><span>i=1:length(odourConc)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            unitID=odourConc(i);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span style="color: rgb(60, 118, 61);">%flow=calcFlow(flowRate);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            flow=calcFlow(flowRate,odourConc);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            flow = round(flow);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            fprintf(</span><span class="nonlocalVariableHighlighting">aliComm</span><span>, sprintf(</span><span style="color: rgb(160, 32, 240);">'%s%g'</span><span>,unitID,flow) );</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span class="warning_squiggle_rte">A</span><span> = readMFC(</span><span class="nonlocalVariableHighlighting">aliComm</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            sprintf(</span><span style="color: rgb(160, 32, 240);">'%s%g'</span><span>,unitID,flow);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    flushAlicatBuffer;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">elseif </span><span>isnumeric(odourConc)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(60, 118, 61);">% We will pass 1 SLPM total and allow the odour to from 0 to 100</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(60, 118, 61);">% percent of this range.   </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        flowA = flowRate*(1-odourConc); </span><span style="color: rgb(60, 118, 61);">% MFC A: clean carrier air stream.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        flowB = flowRate*odourConc;     </span><span style="color: rgb(60, 118, 61);">% MFC B: odourised air stream.</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">if </span><span>flowA&gt;1 || flowA&lt;0, error(</span><span style="color: rgb(160, 32, 240);">'FlowA out of bounds'</span><span>), </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">if </span><span>flowB&gt;1 || flowB&lt;0, error(</span><span style="color: rgb(160, 32, 240);">'FlowB out of bounds'</span><span>), </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>       </span><span style="color: rgb(60, 118, 61);">%Convert to correct units for MFC</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        flowA=calcFlow(flowA);  flowB=calcFlow(flowB);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>       fprintf(</span><span class="nonlocalVariableHighlighting">aliComm</span><span>, sprintf(</span><span style="color: rgb(160, 32, 240);">'%s%0.0f'</span><span>,</span><span style="color: rgb(160, 32, 240);">'A'</span><span>,flowA) );</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>       fprintf(</span><span class="nonlocalVariableHighlighting">aliComm</span><span>, sprintf(</span><span style="color: rgb(160, 32, 240);">'%s%0.0f'</span><span>,</span><span style="color: rgb(160, 32, 240);">'B'</span><span>,flowB) );</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><h4  class = 'S2'><span>a</span></h4><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>flow=calcFlow(setPoint, UnitID)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% function flow=calcFlow(setPoint)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% Convert a desired flow rate into the correct units for the MFC. See p. 22</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% of operating manual. </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">% (desired set point * 64000)/Full scale range </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%format shortG %Formats the notation such that there's no exp notation</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%flow = (setPoint * 64000)/5; %64000/5 for MFC E</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">if </span><span>UnitID == </span><span style="color: rgb(160, 32, 240);">'A'</span><span>|| UnitID == </span><span style="color: rgb(160, 32, 240);">'B'</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        flow = (setPoint * 64000)/50; </span><span style="color: rgb(60, 118, 61);">%ISA50 and ISB50 %64000/50 for MFC A and B</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">elseif </span><span>UnitID == </span><span style="color: rgb(160, 32, 240);">'C'</span><span>||UnitID == </span><span style="color: rgb(160, 32, 240);">'D'</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        flow = (setPoint * 64000)/1; </span><span style="color: rgb(60, 118, 61);">%ISA1 and ISAB1 %64000/1 for MFC C and D</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">else </span><span style="color: rgb(60, 118, 61);">%if UnitID is E</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        flow = (setPoint * 64000)/5; </span><span style="color: rgb(60, 118, 61);">%64000/5 for MFC E</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>flushAlicatBuffer</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">global </span><span class="nonlocalVariableHighlighting">aliComm</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">if </span><span>isempty(</span><span class="nonlocalVariableHighlighting">aliComm</span><span>), </span><span class="nonlocalVariableHighlighting">aliComm</span><span>=connectAlicat; </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%fprintf('Flushing Alicat serial buffer')</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">while </span><span class="nonlocalVariableHighlighting">aliComm</span><span>.BytesAvailable&gt;0</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        fread(</span><span class="nonlocalVariableHighlighting">aliComm</span><span>,</span><span class="nonlocalVariableHighlighting">aliComm</span><span>.BytesAvailable);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(60, 118, 61);">%fprintf('.')</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(60, 118, 61);">%pause(0.05)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    fprintf(</span><span style="color: rgb(160, 32, 240);">'\n'</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><h2  class = 'S4'><span>Arduino Setup &amp; Functions</span></h2><h4  class = 'S2'><span>Connect to Arduino</span></h4><div  class = 'S1'><span>Purpose: Form a connection to the Arduino controller. If no input argument, connects to an Uno board on COM port 6. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>ar = ConnectArduino(Com,Board)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    COM=</span><span style="color: rgb(160, 32, 240);">'COM6'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    board = </span><span style="color: rgb(160, 32, 240);">'Uno'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">switch </span><span>nargin</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">case </span><span>1</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            COM = Com;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">case </span><span>2</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            board = Board;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    ar = arduino(COM, board, </span><span style="color: rgb(160, 32, 240);">'Libraries'</span><span>, </span><span style="color: rgb(160, 32, 240);">'I2C'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><h4  class = 'S2'><span>Connect Sensors &amp; Transducers</span></h4><div  class = 'S1'><span>**May need to accept arduino as input from app class**</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>[Sensors,Transducers] = </span><span class="warning_squiggle_rte">Initialize</span><span>(ar)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%if isempty(ar), ar = ConnectArduino; end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    addrs = scanI2CBus(ar);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">for </span><span>i = 1:length(addrs)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">switch </span><span>addrs{i}</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 0, 255);">case </span><span>{</span><span style="color: rgb(160, 32, 240);">'0x48'</span><span>,</span><span style="color: rgb(160, 32, 240);">'0x49'</span><span>}</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                Sensors.Radiometer = Radiometer(ar,addrs{i});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 0, 255);">case </span><span>{</span><span style="color: rgb(160, 32, 240);">'0x4A'</span><span>,</span><span class="warning_squiggle_rte" style="color: rgb(160, 32, 240);">'0x4A'</span><span>}</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                Sensors.Thermistor_1 = Thermistor(ar);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                Sensors.Thermistor_2 = Thermistor(ar,1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 0, 255);">case </span><span style="color: rgb(160, 32, 240);">'0x67'</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                Sensors.Thermocouple = mcp9600(ar, addrs{i});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span style="color: rgb(0, 0, 255);">case </span><span>{</span><span style="color: rgb(160, 32, 240);">'0x18'</span><span>,</span><span style="color: rgb(160, 32, 240);">'0x19'</span><span>}</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                Transducers.Relay = Relay(ar,addrs{i});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span style="color: rgb(60, 118, 61);">%case -pressure sensor address-</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                </span><span style="color: rgb(60, 118, 61);">%Pressure sensor class</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>            </span><span style="color: rgb(60, 118, 61);">%case -Scale address-</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>                </span><span style="color: rgb(60, 118, 61);">%Scale Class</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>        </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(0, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%Sensors.Camera = </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    Transducers.ArmMotor = DCMotor(ar);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">%{</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">function Report = SensorCheck()</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">    global Sensors</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">    if isempty(Sensors), Sensors = InitializeSensors; end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">    needed = {'',''};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">    if ~isfield(Sensors,needed)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">        Report = [fieldnames(Sensors,)];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">    end</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">%}</span></span></div></div></div><div  class = 'S9'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'></div></div></div><h2  class = 'S4'><span>Sensor/Transducer Functions</span></h2><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>T = thermocouple_read(Sensors)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    T </span><span class="warning_squiggle_rte warningHighlight">=</span><span> Sensors.Thermocouple.readHotJunc()</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span class="warning_squiggle_rte">F</span><span> = radiometer_read(Sensors)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte">v</span><span> </span><span class="warning_squiggle_rte warningHighlight">=</span><span> readVoltage(Sensors.ADC1.Device,Sensors.ADC1.RadPin)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte">T_d</span><span> = thermistor_read(Sensors.ADC2.Device,Sensors.ADC2.Therm1Pin);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte">T_c</span><span> = thermistor_read(Sensors.ADC2.Device,Sensors.ADC2.Therm2Pin);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%F = </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span class="warning_squiggle_rte">T</span><span> = thermistor_read(Dev,pin)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span class="warning_squiggle_rte">v</span><span> </span><span class="warning_squiggle_rte warningHighlight">=</span><span> readVoltage(Dev,pin)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span><span style="color: rgb(60, 118, 61);">%T = </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span>[</span><span class="warning_squiggle_rte">P</span><span>,</span><span class="warning_squiggle_rte">T</span><span>] = pressure_read(</span><span class="warning_squiggle_rte warningHighlight">Sensors</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>    </span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S5'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">function </span><span class="warning_squiggle_rte">W</span><span> = scale_read(</span><span class="warning_squiggle_rte warningHighlight">Sensors</span><span>)</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span style="color: rgb(0, 0, 255);">end</span></span></div></div></div><div  class = 'S9'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S10'></div></div></div><div  class = 'S9'></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
function f = Func_Lib
%% FUNC_LIB Function Library
% Creates a structure of function handles. To use, call the function at the 
% beginning of your script and assign to a variable. From there call a function 
% within the structure as you would any structure field
% Ex:
%%
% 
%   f = Func_lib;
%   a = f.V_Comp(V_1,V_2,V_s);
%
%% Main Function
    f.connectAlicat = @connectAlicat;
    f.setFlow = @setFlow;
    f.calcFlow = @calcFlow;
    f.flushAlicatBuffer= @flushAlicatBuffer;
    f.ConnectArduino = @ConnectArduino;
    f.InitializeSensors = @InitializeSensors;
    f.thermocouple_read = @thermocouple_read;
    f.radiometer_read = @radiometer_read;
    f.pressure_read = @pressure_read;
    f.scale_read = @scale_read;
    f.thermistor_read = @thermistor_read;
end
%% Alicat Setup and Functions
% a
function aliComm=connectAlicat
    % * Purpose
    % Form a connection to the Alicat controller. By default 
    % connects to COM port hard-coded into file. User may overide
    % this.
    COM='COM1';
    fprintf('Connecting to Alicats on port %s\n',COM)
    
    aliComm=serial(COM,...
        'TimeOut', 2,...
        'BaudRate', 19200,...
        'Terminator','CR');
    %delete(instrfind)
    fopen(aliComm);
    %fclose(aliComm)
    %delete(aliComm)
    %clear aliComm
end
% a
function setFlow(flowRate,odourConc)
    % function setFlow(flowRate,odourConc)
    %
    % Set the flow rate of the combined odour stream and the odour
    % concentration. Or change flow of just one controller:
    %
    % flowRate - desired flow rate produced by both controllers (unless
    %            odourConc is a controller ID). UNITS: SLPM.
    % odourConc- i. maintains the same overall flow rate but changes the odour
    %            concentration. UNITS: 0REPLACE_WITH_DASH_DASH100% of 1 SLPM 
    %            ii. If odourConc is a controller ID (e.g. 'A' or 'B') then the 
    %            function sets the named controller to the flow  pecified by 
    %            flowRate. Can be a char array of several unit IDs in which
    %            case all are set to flowRate.
    % examples -
    % setFlow(0.5,'A') %Set controler A to half full scale
    % setFlow(2100/5000,'C') %Set 5 SLPM controler, C, to 2.1 SLPM
    %
    % Rob Campbell - 21st March 2008 - CSHL
    % flowRate = flowRate/20;
    global aliComm;
    if isempty(aliComm), aliComm=connectAlicat; end
    if ischar(odourConc)
        
        flowRate=round(flowRate*1000)/1000;
        flowRate=str2double(sprintf('%0.3g',flowRate));
        for i=1:length(odourConc)
            unitID=odourConc(i);
            %flow=calcFlow(flowRate);
            flow=calcFlow(flowRate,odourConc);
            flow = round(flow);
            fprintf(aliComm, sprintf('%s%g',unitID,flow) );
            A = readMFC(aliComm);
            sprintf('%s%g',unitID,flow);
        end
    flushAlicatBuffer;
    
    elseif isnumeric(odourConc)
        
        % We will pass 1 SLPM total and allow the odour to from 0 to 100
        % percent of this range.   
        flowA = flowRate*(1-odourConc); % MFC A: clean carrier air stream.
        flowB = flowRate*odourConc;     % MFC B: odourised air stream.
        
        if flowA>1 || flowA<0, error('FlowA out of bounds'), end
        if flowB>1 || flowB<0, error('FlowB out of bounds'), end
       %Convert to correct units for MFC
        flowA=calcFlow(flowA);  flowB=calcFlow(flowB);
    
       fprintf(aliComm, sprintf('%s%0.0f','A',flowA) );
       fprintf(aliComm, sprintf('%s%0.0f','B',flowB) );
    end
end
% a
function flow=calcFlow(setPoint, UnitID)
    % function flow=calcFlow(setPoint)
    %
    % Convert a desired flow rate into the correct units for the MFC. See p. 22
    % of operating manual. 
    % (desired set point * 64000)/Full scale range 
    %format shortG %Formats the notation such that there's no exp notation
    %flow = (setPoint * 64000)/5; %64000/5 for MFC E
    if UnitID == 'A'|| UnitID == 'B'
        flow = (setPoint * 64000)/50; %ISA50 and ISB50 %64000/50 for MFC A and B
    elseif UnitID == 'C'||UnitID == 'D'
        flow = (setPoint * 64000)/1; %ISA1 and ISAB1 %64000/1 for MFC C and D
    else %if UnitID is E
        flow = (setPoint * 64000)/5; %64000/5 for MFC E
    end
end
function flushAlicatBuffer
    
    global aliComm;
    if isempty(aliComm), aliComm=connectAlicat; end
    
    %fprintf('Flushing Alicat serial buffer')
    while aliComm.BytesAvailable>0
        fread(aliComm,aliComm.BytesAvailable);
        %fprintf('.')
        %pause(0.05)
    end
    fprintf('\n')
end
%% Arduino Setup & Functions
% Connect to Arduino
% Purpose: Form a connection to the Arduino controller. If no input argument, 
% connects to an Uno board on COM port 6. 
function ar = ConnectArduino(Com,Board)
    COM='COM6';
    board = 'Uno';
    
    switch nargin
        case 1
            COM = Com;
        case 2
            board = Board;
    end
    
    ar = arduino(COM, board, 'Libraries', 'I2C');
end
% Connect Sensors & Transducers
% **May need to accept arduino as input from app class**
function [Sensors,Transducers] = Initialize(ar)
    %if isempty(ar), ar = ConnectArduino; end
    
    addrs = scanI2CBus(ar);
    
    for i = 1:length(addrs)
        switch addrs{i}
            case {'0x48','0x49'}
                Sensors.Radiometer = Radiometer(ar,addrs{i});
            case {'0x4A','0x4A'}
                Sensors.Thermistor_1 = Thermistor(ar);
                Sensors.Thermistor_2 = Thermistor(ar,1);
            case '0x67'
                Sensors.Thermocouple = mcp9600(ar, addrs{i});
            case {'0x18','0x19'}
                Transducers.Relay = Relay(ar,addrs{i});
            %case -pressure sensor address-
                %Pressure sensor class
            %case -Scale address-
                %Scale Class
        end
    end
    %Sensors.Camera = 
    Transducers.ArmMotor = DCMotor(ar);
    
end
%% 
% 
%{
function Report = SensorCheck()
    global Sensors
    if isempty(Sensors), Sensors = InitializeSensors; end
    
    needed = {'',''};
    
    if ~isfield(Sensors,needed)
        Report = [fieldnames(Sensors,)];
    end
    
end
%}
%% 
% 
%% Sensor/Transducer Functions
function T = thermocouple_read(Sensors)
    T = Sensors.Thermocouple.readHotJunc()
end
%% 
% 
function F = radiometer_read(Sensors)
    v = readVoltage(Sensors.ADC1.Device,Sensors.ADC1.RadPin)
    
    T_d = thermistor_read(Sensors.ADC2.Device,Sensors.ADC2.Therm1Pin);
    T_c = thermistor_read(Sensors.ADC2.Device,Sensors.ADC2.Therm2Pin);
    
    %F = 
end
%% 
% 
function T = thermistor_read(Dev,pin)
    v = readVoltage(Dev,pin)
    
    %T = 
end
%% 
% 
function [P,T] = pressure_read(Sensors)
    
end
%% 
% 
function W = scale_read(Sensors)
end
%% 
% 
%% 
%
##### SOURCE END #####
--></body></html>